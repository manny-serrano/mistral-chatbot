{
  "metadata": {
    "report_title": "Network Traffic Analysis Report with Threat Detection (YAF/IPFIX Data)",
    "reporting_period": "2024-05-31T07:36:19.896000+00:00 to 2024-05-31T11:06:19.029000+00:00",
    "generated_by": "LEVANT AI Security Platform",
    "generation_date": "2025-07-16T18:54:20.857025+00:00",
    "report_version": "3.0",
    "analysis_duration_hours": 3.5,
    "analysis_scope": "Normal network flows (excluding known malicious/honeypot traffic)",
    "threat_detection_method": "Pattern matching against known malicious/honeypot signatures",
    "automation_info": {
      "is_automated": true,
      "generation_type": "scheduled",
      "schedule": "Daily at 6:00 AM",
      "frontend_integration": true,
      "api_accessible": true
    }
  },
  "executive_summary": {
    "overall_risk_level": "MEDIUM",
    "key_findings": [
      "High-severity port scanning detected",
      "High-severity data exfiltration detected"
    ],
    "critical_issues_count": 2,
    "recommendations_priority": "SCHEDULED"
  },
  "network_traffic_overview": {
    "basic_stats": {
      "total_flows": 127473,
      "total_bytes": 23990676301,
      "total_packets": 38931511,
      "avg_duration": 223.82011236889846
    },
    "top_sources": [
      {
        "ip": "10.183.3.60",
        "bytes": 6534054600,
        "flow_count": 9,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      },
      {
        "ip": "10.183.13.62",
        "bytes": 1401523941,
        "flow_count": 1663,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      },
      {
        "ip": "10.183.13.48",
        "bytes": 1104916061,
        "flow_count": 817,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      },
      {
        "ip": "10.183.13.64",
        "bytes": 1096018288,
        "flow_count": 849,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      },
      {
        "ip": "10.183.13.148",
        "bytes": 1074280178,
        "flow_count": 930,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      },
      {
        "ip": "10.183.3.64",
        "bytes": 1046093476,
        "flow_count": 9,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      },
      {
        "ip": "10.183.13.50",
        "bytes": 948659213,
        "flow_count": 841,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      },
      {
        "ip": "10.183.13.63",
        "bytes": 947592736,
        "flow_count": 1296,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      },
      {
        "ip": "10.183.13.47",
        "bytes": 926658681,
        "flow_count": 798,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      },
      {
        "ip": "10.183.13.149",
        "bytes": 913081606,
        "flow_count": 789,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      }
    ],
    "top_destinations": [
      {
        "ip": "10.183.13.148",
        "bytes": 5456929886,
        "flow_count": 514,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      },
      {
        "ip": "10.183.3.60",
        "bytes": 1987005056,
        "flow_count": 23,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      },
      {
        "ip": "10.183.3.73",
        "bytes": 1583051372,
        "flow_count": 31,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      },
      {
        "ip": "10.183.3.61",
        "bytes": 1394736512,
        "flow_count": 38,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      },
      {
        "ip": "10.183.3.63",
        "bytes": 1097440268,
        "flow_count": 43,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      },
      {
        "ip": "10.183.3.72",
        "bytes": 1080425056,
        "flow_count": 19,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      },
      {
        "ip": "10.183.13.65",
        "bytes": 1080197602,
        "flow_count": 509,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      },
      {
        "ip": "10.183.13.149",
        "bytes": 1046675323,
        "flow_count": 484,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      },
      {
        "ip": "10.183.3.68",
        "bytes": 929981224,
        "flow_count": 27,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      },
      {
        "ip": "10.183.3.75",
        "bytes": 922004600,
        "flow_count": 40,
        "threat_intel": {
          "is_malicious": false,
          "threat_type": null,
          "confidence": 0.0,
          "sources": []
        }
      }
    ],
    "protocol_breakdown": {
      "TCP": {
        "protocol_id": 6,
        "flow_count": 89915,
        "total_bytes": 23986052160,
        "is_suspicious": false
      },
      "UDP": {
        "protocol_id": 17,
        "flow_count": 37548,
        "total_bytes": 4034509,
        "is_suspicious": false
      },
      "ICMP": {
        "protocol_id": 1,
        "flow_count": 6,
        "total_bytes": 13712,
        "is_suspicious": false
      },
      "Protocol-112": {
        "protocol_id": 112,
        "flow_count": 4,
        "total_bytes": 575920,
        "is_suspicious": false
      }
    },
    "top_ports": {
      "destination_ports": [
        {
          "port": 53,
          "flow_count": 30727,
          "total_bytes": 2534217,
          "service": "DNS",
          "is_malicious": false
        },
        {
          "port": 9273,
          "flow_count": 23988,
          "total_bytes": 31022312,
          "service": "Port-9273",
          "is_malicious": false
        },
        {
          "port": 8089,
          "flow_count": 12633,
          "total_bytes": 25768496,
          "service": "Port-8089",
          "is_malicious": false
        },
        {
          "port": 2049,
          "flow_count": 10171,
          "total_bytes": 14397837180,
          "service": "Port-2049",
          "is_malicious": false
        },
        {
          "port": 9997,
          "flow_count": 7454,
          "total_bytes": 153652751,
          "service": "Port-9997",
          "is_malicious": false
        },
        {
          "port": 6818,
          "flow_count": 2226,
          "total_bytes": 1881893,
          "service": "Port-6818",
          "is_malicious": false
        },
        {
          "port": 123,
          "flow_count": 2194,
          "total_bytes": 166744,
          "service": "Port-123",
          "is_malicious": false
        },
        {
          "port": 41964,
          "flow_count": 2152,
          "total_bytes": 327008,
          "service": "Port-41964",
          "is_malicious": false
        },
        {
          "port": 41965,
          "flow_count": 2150,
          "total_bytes": 326700,
          "service": "Port-41965",
          "is_malicious": false
        },
        {
          "port": 636,
          "flow_count": 2001,
          "total_bytes": 80415006,
          "service": "Port-636",
          "is_malicious": false
        },
        {
          "port": 8080,
          "flow_count": 1736,
          "total_bytes": 9163571,
          "service": "Port-8080",
          "is_malicious": false
        },
        {
          "port": 443,
          "flow_count": 1600,
          "total_bytes": 13142835,
          "service": "HTTPS",
          "is_malicious": false
        },
        {
          "port": 3300,
          "flow_count": 809,
          "total_bytes": 45544296,
          "service": "Port-3300",
          "is_malicious": false
        },
        {
          "port": 6817,
          "flow_count": 628,
          "total_bytes": 725013,
          "service": "Port-6817",
          "is_malicious": false
        },
        {
          "port": 6804,
          "flow_count": 570,
          "total_bytes": 576357066,
          "service": "Port-6804",
          "is_malicious": false
        },
        {
          "port": 1947,
          "flow_count": 420,
          "total_bytes": 28560,
          "service": "Port-1947",
          "is_malicious": false
        },
        {
          "port": 6840,
          "flow_count": 362,
          "total_bytes": 365994460,
          "service": "Port-6840",
          "is_malicious": false
        },
        {
          "port": 445,
          "flow_count": 168,
          "total_bytes": 32701520,
          "service": "Port-445",
          "is_malicious": true
        },
        {
          "port": 138,
          "flow_count": 120,
          "total_bytes": 27480,
          "service": "Port-138",
          "is_malicious": false
        },
        {
          "port": 8140,
          "flow_count": 75,
          "total_bytes": 3319162,
          "service": "Port-8140",
          "is_malicious": false
        }
      ],
      "malicious_ports_detected": true
    },
    "bandwidth_stats": {
      "total_bytes": 48200065993,
      "total_bits": 385600527944,
      "duration_seconds": 12599.133,
      "average_bps": 30605322,
      "average_mbps": 30.61,
      "average_gbps": 0.0306
    }
  },
  "security_findings": {
    "malicious_pattern_matches": {
      "pattern_matches": [],
      "known_malicious_ips": 0,
      "matching_flows": 0,
      "severity": "LOW"
    },
    "honeypot_pattern_matches": {
      "honeypot_matches": [],
      "known_honeypot_ips": 0,
      "known_honeypot_ports": 0,
      "matching_patterns": 0,
      "severity": "LOW"
    },
    "suspicious_connections": {
      "suspicious_pairs": [
        {
          "source_ip": "10.183.254.7",
          "destination_ip": "192.168.32.3",
          "connection_count": 1437
        },
        {
          "source_ip": "10.183.254.7",
          "destination_ip": "192.168.33.3",
          "connection_count": 1435
        },
        {
          "source_ip": "10.183.254.7",
          "destination_ip": "192.168.31.3",
          "connection_count": 1429
        }
      ],
      "count": 3,
      "severity": "MEDIUM"
    },
    "port_scanning": {
      "potential_scanners": [
        {
          "source_ip": "10.138.12.25",
          "ports_scanned": 5352
        },
        {
          "source_ip": "10.183.10.235",
          "ports_scanned": 3505
        },
        {
          "source_ip": "44.209.99.177",
          "ports_scanned": 1932
        },
        {
          "source_ip": "44.205.209.155",
          "ports_scanned": 1930
        },
        {
          "source_ip": "34.236.212.125",
          "ports_scanned": 1906
        },
        {
          "source_ip": "10.138.2.147",
          "ports_scanned": 715
        },
        {
          "source_ip": "152.3.72.177",
          "ports_scanned": 393
        },
        {
          "source_ip": "152.3.70.64",
          "ports_scanned": 364
        },
        {
          "source_ip": "10.183.5.185",
          "ports_scanned": 195
        },
        {
          "source_ip": "152.3.80.200",
          "ports_scanned": 151
        }
      ],
      "count": 10,
      "severity": "HIGH"
    },
    "data_exfiltration": {
      "high_volume_sources": [
        {
          "source_ip": "10.183.3.60",
          "bytes_sent": 6534054600,
          "gb_sent": 6.53
        },
        {
          "source_ip": "10.183.13.62",
          "bytes_sent": 1401523941,
          "gb_sent": 1.4
        },
        {
          "source_ip": "10.183.13.48",
          "bytes_sent": 1104916061,
          "gb_sent": 1.1
        },
        {
          "source_ip": "10.183.13.64",
          "bytes_sent": 1096018288,
          "gb_sent": 1.1
        },
        {
          "source_ip": "10.183.13.148",
          "bytes_sent": 1074280178,
          "gb_sent": 1.07
        },
        {
          "source_ip": "10.183.3.64",
          "bytes_sent": 1046093476,
          "gb_sent": 1.05
        }
      ],
      "count": 6,
      "severity": "HIGH"
    },
    "unusual_protocols": {
      "unusual_protocols": [],
      "count": 0,
      "severity": "LOW"
    },
    "threat_intelligence_matches": {
      "threat_matches": [],
      "total_threat_patterns": 0,
      "matching_patterns": 0,
      "severity": "LOW"
    }
  },
  "data_sources_and_configuration": {
    "primary_data_source": "Neo4j Graph Database",
    "yaf_ipfix_sensors": [
      "YAF Sensor Network"
    ],
    "threat_intelligence_sources": [
      "Known malicious flow signatures from honeypot data",
      "Malicious IP patterns from security incidents",
      "Port/protocol patterns from attack samples"
    ],
    "analysis_methodology": {
      "normal_traffic_analysis": "Baseline network behavior from clean flows",
      "threat_detection": "Pattern matching against known malicious signatures",
      "comparison_scope": "IP addresses, ports, protocols, and traffic patterns"
    },
    "ipfix_information_elements": [
      "sourceIPv4Address",
      "destinationIPv4Address",
      "sourceTransportPort",
      "destinationTransportPort",
      "protocolIdentifier",
      "octetTotalCount",
      "packetTotalCount",
      "flowStartMilliseconds",
      "flowEndMilliseconds"
    ],
    "configuration_details": {
      "sampling_rate": "1:1 (no sampling)",
      "flow_timeout": "Active: 30min, Inactive: 15sec",
      "collection_method": "IPFIX over TCP"
    }
  },
  "recommendations_and_next_steps": {
    "prioritized_recommendations": [
      {
        "priority": "IMMEDIATE",
        "category": "Port Scanning",
        "finding": "Detected 10 potential port scanners",
        "recommendation": "Block scanning sources and review firewall rules",
        "estimated_effort": "Medium",
        "timeline": "24 hours"
      },
      {
        "priority": "IMMEDIATE",
        "category": "Data Exfiltration",
        "finding": "Detected 6 high-volume data transfers",
        "recommendation": "Investigate data transfers and implement DLP controls",
        "estimated_effort": "High",
        "timeline": "48 hours"
      },
      {
        "priority": "SCHEDULED",
        "category": "Suspicious Connections",
        "finding": "Medium-severity suspicious connections detected",
        "recommendation": "Schedule detailed analysis and implement monitoring",
        "estimated_effort": "Medium",
        "timeline": "1-2 weeks"
      },
      {
        "priority": "ONGOING",
        "category": "Monitoring",
        "finding": "Continuous network monitoring needed",
        "recommendation": "Implement 24/7 SIEM monitoring and automated threat detection",
        "estimated_effort": "High",
        "timeline": "1-3 months"
      },
      {
        "priority": "ONGOING",
        "category": "Threat Intelligence",
        "finding": "Limited threat intelligence integration",
        "recommendation": "Integrate multiple threat intelligence feeds for better detection",
        "estimated_effort": "Medium",
        "timeline": "2-4 weeks"
      }
    ],
    "further_investigation_areas": [
      "Deep packet inspection of suspicious flows",
      "Correlation with external threat intelligence",
      "Historical trend analysis",
      "User behavior analytics"
    ],
    "security_control_adjustments": [
      "Firewall rule optimization",
      "IDS/IPS signature updates",
      "Network segmentation review",
      "Access control policy updates"
    ]
  },
  "compliance_and_governance": {
    "data_retention_policy": "Network flow data retained for 90 days",
    "privacy_controls": "IP addresses anonymized where required",
    "access_controls": "Report access restricted to authorized security personnel",
    "audit_trail": "All report generation activities logged"
  },
  "ai_analysis": []
}